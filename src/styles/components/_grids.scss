// ============================================
// GRID COMPONENT - Fully Responsive & Flexible
// ============================================

@use "../variables.scss" as *;
@use "../mixins.scss" as *;

.pta-grid {
  display: flex;
  width: 100%;

  // ============================================
  // DIRECTION VARIANTS - Responsive
  // ============================================

  @include direction-variant(row);
  @include direction-variant(column);
  @include direction-variant(row-reverse);
  @include direction-variant(column-reverse);

  // Mobile: auto-column on small screens
  &--auto-column-mobile {
    flex-direction: column;

    @include respond-above(md) {
      flex-direction: row;
    }
  }

  // ============================================
  // JUSTIFY VARIANTS
  // ============================================

  @include justify-variant(start);
  @include justify-variant(center);
  @include justify-variant(end);
  @include justify-variant(between);
  @include justify-variant(around);
  @include justify-variant(evenly);

  // ============================================
  // ALIGN VARIANTS
  // ============================================

  @include align-variant(start);
  @include align-variant(center);
  @include align-variant(end);
  @include align-variant(stretch);
  @include align-variant(baseline);

  // ============================================
  // GAP VARIANTS - Responsive
  // ============================================

  @include gap-variant(xs);
  @include gap-variant(sm);
  @include gap-variant(md);
  @include gap-variant(lg);
  @include gap-variant(xl);
  @include gap-variant(2xl);

  // Responsive gap
  &--gap-responsive {
    gap: $spacing-sm;

    @include respond-above(md) {
      gap: $spacing-md;
    }

    @include respond-above(lg) {
      gap: $spacing-lg;
    }

    @include respond-above(xl) {
      gap: $spacing-xl;
    }
  }

  // ============================================
  // WRAP VARIANTS
  // ============================================

  &--wrap {
    flex-wrap: wrap;
  }

  &--nowrap {
    flex-wrap: nowrap;
  }

  &--wrap-reverse {
    flex-wrap: wrap-reverse;
  }

  // Responsive wrap
  &--wrap-mobile {
    flex-wrap: wrap;

    @include respond-above(md) {
      flex-wrap: nowrap;
    }
  }

  // ============================================
  // GRID MODE - CSS Grid
  // ============================================

  &--mode-grid {
    display: grid;
    grid-template-columns: var(--grid-template-columns, repeat(auto-fit, minmax(250px, 1fr)));
    grid-template-rows: var(--grid-template-rows, auto);

    // Responsive columns
    &.pta-grid--cols-1 {
      grid-template-columns: 1fr;
    }

    &.pta-grid--cols-2 {
      grid-template-columns: repeat(1, 1fr);

      @include respond-above(sm) {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    &.pta-grid--cols-3 {
      grid-template-columns: repeat(1, 1fr);

      @include respond-above(sm) {
        grid-template-columns: repeat(2, 1fr);
      }

      @include respond-above(md) {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    &.pta-grid--cols-4 {
      grid-template-columns: repeat(1, 1fr);

      @include respond-above(sm) {
        grid-template-columns: repeat(2, 1fr);
      }

      @include respond-above(md) {
        grid-template-columns: repeat(3, 1fr);
      }

      @include respond-above(lg) {
        grid-template-columns: repeat(4, 1fr);
      }
    }

    &.pta-grid--cols-5 {
      grid-template-columns: repeat(2, 1fr);

      @include respond-above(md) {
        grid-template-columns: repeat(3, 1fr);
      }

      @include respond-above(lg) {
        grid-template-columns: repeat(4, 1fr);
      }

      @include respond-above(xl) {
        grid-template-columns: repeat(5, 1fr);
      }
    }

    &.pta-grid--cols-6 {
      grid-template-columns: repeat(2, 1fr);

      @include respond-above(md) {
        grid-template-columns: repeat(3, 1fr);
      }

      @include respond-above(lg) {
        grid-template-columns: repeat(4, 1fr);
      }

      @include respond-above(xl) {
        grid-template-columns: repeat(6, 1fr);
      }
    }

    // Auto-fit & Auto-fill
    &.pta-grid--auto-fit {
      grid-template-columns: repeat(auto-fit, minmax(min(100%, 250px), 1fr));
    }

    &.pta-grid--auto-fill {
      grid-template-columns: repeat(auto-fill, minmax(min(100%, 250px), 1fr));
    }
  }

  // ============================================
  // GRID AUTO FLOW
  // ============================================

  @include grid-auto-flow-variant(row);
  @include grid-auto-flow-variant(column);
  @include grid-auto-flow-variant(dense);
  @include grid-auto-flow-variant(row-dense);
  @include grid-auto-flow-variant(column-dense);

  // ============================================
  // SPECIAL LAYOUTS
  // ============================================

  // Sidebar layout
  &--layout-sidebar {
    display: grid;
    gap: $spacing-lg;

    // Mobile: stack
    grid-template-columns: 1fr;
    grid-template-areas:
      "main"
      "sidebar";

    // Desktop: side by side
    @include respond-above(lg) {
      grid-template-columns: 1fr 300px;
      grid-template-areas: "main sidebar";
    }

    @include respond-above(xl) {
      grid-template-columns: 1fr 400px;
      gap: $spacing-xl;
    }
  }

  // Holy grail layout
  &--layout-holy-grail {
    display: grid;
    gap: $spacing-md;
    min-height: 100vh;

    // Mobile: all stacked
    grid-template-areas:
      "header"
      "nav"
      "main"
      "aside"
      "footer";
    grid-template-columns: 1fr;
    grid-template-rows: auto auto 1fr auto auto;

    // Desktop: classic holy grail
    @include respond-above(lg) {
      grid-template-areas:
        "header header header"
        "nav main aside"
        "footer footer footer";
      grid-template-columns: 200px 1fr 200px;
      grid-template-rows: auto 1fr auto;
      gap: $spacing-lg;
    }

    @include respond-above(xl) {
      grid-template-columns: 250px 1fr 250px;
      gap: $spacing-xl;
    }
  }

  // Masonry-like (auto-fit with variable heights)
  &--layout-masonry {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(min(100%, 250px), 1fr));
    grid-auto-rows: masonry; // Future CSS feature
    gap: $spacing-md;

    @include respond-above(md) {
      gap: $spacing-lg;
    }

    // Fallback for browsers without masonry support
    @supports not (grid-auto-rows: masonry) {
      display: flex;
      flex-wrap: wrap;

      > * {
        flex: 1 1 250px;
        max-width: 100%;
      }
    }
  }

  // ============================================
  // ITEM UTILITIES
  // ============================================

  &__item {
    min-width: 0; // Prevent overflow
    min-height: 0;

    &--span-2 {
      @include respond-above(md) {
        grid-column: span 2;
      }
    }

    &--span-3 {
      @include respond-above(lg) {
        grid-column: span 3;
      }
    }

    &--span-full {
      grid-column: 1 / -1;
    }

    &--row-span-2 {
      @include respond-above(md) {
        grid-row: span 2;
      }
    }

    &--order-1 {
      order: 1;
    }

    &--order-2 {
      order: 2;
    }

    &--order-3 {
      order: 3;
    }

    // Responsive order
    &--order-mobile-first {
      order: -1;

      @include respond-above(md) {
        order: 0;
      }
    }

    &--order-mobile-last {
      order: 999;

      @include respond-above(md) {
        order: 0;
      }
    }
  }

  // ============================================
  // RESPONSIVE ADJUSTMENTS
  // ============================================

  // Mobile landscape
  @media (max-height: 600px) and (orientation: landscape) {
    &--mode-grid {
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
  }

  // Reduced motion
  @media (prefers-reduced-motion: reduce) {
    transition: none;
  }

  // Print optimization
  @media print {
    &--mode-grid {
      display: block;
    }

    gap: $spacing-sm !important;
  }
}
